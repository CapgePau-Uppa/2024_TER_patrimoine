<header>
  <app-navbar></app-navbar>
</header>

<main>

  <aside>
    <div class="links-container">
      <a (click)="switchToSuggestion()" [class.active]="historiqueMode">Suggestion</a>
      <a (click)="switchToHistorique()" [class.active]="!historiqueMode">Historique</a>
  </div>
    <div *ngFor="let building of buildings">
      <app-suggestion [batName]="building.nomBatiment"
                      [ngClass]="{'selected': building === buildingInfo}"
                      (click)="building?.id && getBuildingInformation(building.id)">
      </app-suggestion>
    </div>
  </aside>

  
  <div id="container">
    <div id="information" *ngIf="buildingInfo">
      <p>Suggestion de : {{ buildingInfo.nomUser }} {{ buildingInfo.prenomUser }}</p>

      <div class="grid-container" [class.disabled]="!modificationActive">
        <div class="grid-item image">
          <img src="../../../assets/img/chateau.png" alt="" loading="lazy">
        </div>

        <div class="grid-item" *ngIf="etapeCourante === 0">
        <div class="form">
          <label for="batName">Nom du bâtiment</label>
          <input type="text" id="batName" [(ngModel)]="buildingInfo.nomBatiment" [disabled]="!modificationActive">
        </div>

        <div class="form">
          <label for="batType">Type de bâtiment</label>
          <select id="batType" class="form-control"  [(ngModel)]="buildingInfo.type" [disabled]="!modificationActive">
            <option *ngFor="let type of types" [value]="type">{{ majuscule(type.toLowerCase()) }}</option>
          </select>
        </div>

        <div class="form">
          <label for="batStatut">Statut </label>
          <select id="batStatut" class="form-control"[(ngModel)]="buildingInfo.statut" [disabled]="!modificationActive">
            <option *ngFor="let statut of statuts" [value]="statut">{{ majuscule(statut) }}</option>
          </select>
        </div>

        <div class="form">
          <label for="description">Description</label>
          <textarea id="batDescription" [(ngModel)]="buildingInfo.description"  cols="30" rows="6" [disabled]="!modificationActive"></textarea>
        </div>

        <button class="suivant" (click)="etapeSuivante()">
          Suivant &nbsp; <i class="fas fa-arrow-right"></i>
        </button> 
        
    </div>
    <div class="grid-item" *ngIf="etapeCourante === 1">
      <div class="form">
        <label for="region">Région</label>
        <select id="batRegion" class="form-control" [(ngModel)]="buildingInfo.region" [disabled]="!modificationActive" (change)="onRegionChange(buildingInfo.region)">
          <option *ngFor="let region of regions" [value]="region">{{ region }}</option>
        </select>
      </div>

      <div class="form">
        <label for="departement">Département</label>
        <select  id="batDepartement" class="form-control" [(ngModel)]="buildingInfo.departement" [disabled]="!modificationActive" (change)="onDepartementChange(buildingInfo.departement)">
          <option *ngFor="let departement of departements" [value]="departement">{{ departement }}</option>
        </select>
      </div>

      <div class="form">
        <label for="commune">Commune</label>
        <select id="batCommune" class="form-control" [(ngModel)]="buildingInfo.commune" [disabled]="!modificationActive">
          <option selected>{{ buildingInfo.commune }}</option>
          <option *ngFor="let commune of communes" [value]="commune">{{ commune }}</option>
        </select>
      </div>

      <div class="form">
        <label for="batAddress">Adresse</label>
        <input type="text" id="batAddress" [(ngModel)]="buildingInfo.adresse" [disabled]="!modificationActive">
      </div>
      <div class="form">
        <label for="coord">Coordonnées</label>
        <div class="coord">
          <input type="text" id="coord-lat" [(ngModel)]="buildingInfo.lat" [disabled]="!modificationActive">
          <input type="text" id="coord-lon" [(ngModel)]="buildingInfo.lon" [disabled]="!modificationActive">
        </div>
      </div>
      <button class="precedent" (click)="etapePrecedente()">
        <i class="fas fa-arrow-left"></i> &nbsp; Précedent
      </button>
      
  </div>
    </div>


    </div>
    <div *ngIf="isSuggestionView"> 
      <div id="buttons">
        <div class="option">
          <app-button [buttonClass]="'btn-blue'" (click)="valider()">
            <img src="../assets/icones/valider.png" alt="Modifier" loading="lazy">
          </app-button>
          <p>Valider</p>
        </div>
    
        <div class="option">
          <app-button [buttonClass]="'btn-blue'" (click)="modifier()">
            <img src="../assets/icones/modifier.png" alt="Modifier" loading="lazy">
          </app-button>
          <p>Modifier</p>
        </div>
    
        <div class="option">
          <app-button [buttonClass]="'btn-blue'" (click)="buildingInfo && supprimer(buildingInfo.id)">
            <img src="../assets/icones/annuler.png" alt="Annuler" loading="lazy">
          </app-button>
          <p>Supprimer</p>
        </div>
      </div>
    </div>
    <div *ngIf="!isSuggestionView">
      <div class="option">
        <app-button [buttonClass]="'btn-blue'" (click)="restaurer()">
          <img src="../assets/icones/modifier.png" alt="Restaurer" loading="lazy">
        </app-button>
        <p>Restaurer</p>
      </div>
    </div>
  </div>


</main>
