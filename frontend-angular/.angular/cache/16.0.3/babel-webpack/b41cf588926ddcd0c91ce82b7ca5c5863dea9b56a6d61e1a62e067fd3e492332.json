{"ast":null,"code":"import * as L from 'leaflet';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./batiment.service\";\nclass CarteComponent {\n  constructor(batimentService) {\n    this.batimentService = batimentService;\n    this.batiments = [];\n  }\n  ngAfterViewInit() {\n    if (typeof this.map === 'undefined') {\n      this.createMap();\n      this.getUserLocation();\n      this.loadBatiments();\n    }\n  }\n  createMap() {\n    const franceCenter = {\n      lat: 46.603354,\n      lng: 1.888334\n    };\n    const zoomLevel = 6;\n    this.map = L.map('map', {\n      center: [franceCenter.lat, franceCenter.lng],\n      zoom: zoomLevel\n    });\n    const mainLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      minZoom: 2,\n      maxZoom: 19\n    });\n    mainLayer.addTo(this.map);\n  }\n  getUserLocation() {\n    const menIcon = L.icon({\n      iconUrl: '../assets/men.png',\n      iconSize: [22, 50],\n      popupAnchor: [0, -30]\n    });\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const userLat = position.coords.latitude;\n        const userLng = position.coords.longitude;\n        this.map.setView([userLat, userLng], 16);\n        L.marker([userLat, userLng], {\n          icon: menIcon\n        }).addTo(this.map).bindPopup('Your position').openPopup();\n      }, error => {\n        console.error('Geolocation error : ', error);\n      });\n    } else {\n      console.error('Geolocation is not supported by this browser.');\n    }\n  }\n  loadBatiments() {\n    this.batimentService.getBatiments().subscribe(data => {\n      this.batiments = data;\n      this.addMarkers();\n    });\n  }\n  addMarkers() {\n    this.batiments.forEach(batiment => {\n      const marker = L.marker([batiment.lat, batiment.lon]).addTo(this.map);\n      const cardContent = `\n        <div class=\"card\">\n          <img src=\"${batiment.image}\" class=\"card-img-top\" alt=\"Batiment\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\" style=\"text-align : center\">${batiment.nom}</h5>\n            <p class=\"card-text\">Type: ${batiment.type}</p>\n            <p class=\"card-text\">Statut: ${batiment.statut}</p>\n          </div>\n        </div>\n      `;\n      marker.bindPopup(cardContent);\n      marker.bindTooltip(batiment.nom);\n      //lorsqu'on clique des details apparaissent\n      marker.on('click', () => {\n        marker.openPopup();\n      });\n      //en survole que le nom\n      marker.on('mouseover', () => {\n        marker.openTooltip();\n      });\n      marker.on('mouseout', () => {\n        marker.closeTooltip();\n      });\n    });\n  }\n}\nCarteComponent.ɵfac = function CarteComponent_Factory(t) {\n  return new (t || CarteComponent)(i0.ɵɵdirectiveInject(i1.BatimentService));\n};\nCarteComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CarteComponent,\n  selectors: [[\"app-carte\"]],\n  decls: 3,\n  vars: 0,\n  consts: [[1, \"map-wrapper\"], [1, \"map-border\"], [\"id\", \"map\"]],\n  template: function CarteComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n      i0.ɵɵelement(2, \"div\", 2);\n      i0.ɵɵelementEnd()();\n    }\n  },\n  styles: [\".map-wrapper[_ngcontent-%COMP%] {\\r\\n  position: relative;\\r\\n  height: 100vh;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.map-border[_ngcontent-%COMP%] {\\r\\n  border: 1px solid white;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n#map[_ngcontent-%COMP%] {\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2FydGUvY2FydGUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGtCQUFrQjtFQUNsQixhQUFhO0VBQ2IsVUFBVTtBQUNaOztBQUVBO0VBQ0UsdUJBQXVCO0VBQ3ZCLFlBQVk7QUFDZDs7QUFFQTtFQUNFLFlBQVk7RUFDWixXQUFXO0FBQ2IiLCJzb3VyY2VzQ29udGVudCI6WyIubWFwLXdyYXBwZXIge1xyXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICBoZWlnaHQ6IDEwMHZoO1xyXG4gIHotaW5kZXg6IDE7XHJcbn1cclxuXHJcbi5tYXAtYm9yZGVyIHtcclxuICBib3JkZXI6IDFweCBzb2xpZCB3aGl0ZTtcclxuICBoZWlnaHQ6IDEwMCU7XHJcbn1cclxuXHJcbiNtYXAge1xyXG4gIGhlaWdodDogMTAwJTtcclxuICB3aWR0aDogMTAwJTtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});\nexport { CarteComponent };","map":{"version":3,"names":["L","CarteComponent","constructor","batimentService","batiments","ngAfterViewInit","map","createMap","getUserLocation","loadBatiments","franceCenter","lat","lng","zoomLevel","center","zoom","mainLayer","tileLayer","minZoom","maxZoom","addTo","menIcon","icon","iconUrl","iconSize","popupAnchor","navigator","geolocation","getCurrentPosition","position","userLat","coords","latitude","userLng","longitude","setView","marker","bindPopup","openPopup","error","console","getBatiments","subscribe","data","addMarkers","forEach","batiment","lon","cardContent","image","nom","type","statut","bindTooltip","on","openTooltip","closeTooltip","i0","ɵɵdirectiveInject","i1","BatimentService","selectors","decls","vars","consts","template","CarteComponent_Template","rf","ctx","ɵɵelementStart","ɵɵelement","ɵɵelementEnd"],"sources":["C:\\Users\\Easy Services Pro\\Documents\\GitHub\\2024_TER_patrimoine\\frontend-angular\\src\\app\\carte\\carte.component.ts","C:\\Users\\Easy Services Pro\\Documents\\GitHub\\2024_TER_patrimoine\\frontend-angular\\src\\app\\carte\\carte.component.html"],"sourcesContent":["import { AfterViewInit, Component } from '@angular/core';\r\nimport * as L from 'leaflet';\r\nimport { BatimentDTO } from './batiment-dto.model';\r\nimport { BatimentService } from './batiment.service';\r\n\r\n@Component({\r\n  selector: 'app-carte',\r\n  templateUrl: './carte.component.html',\r\n  styleUrls: ['./carte.component.css']\r\n})\r\nexport class CarteComponent implements AfterViewInit {\r\n  map: L.Map |undefined ;\r\n  batiments: BatimentDTO[] = [];\r\n\r\n  constructor(private batimentService: BatimentService) { }\r\n\r\n  ngAfterViewInit(): void {\r\n    if (typeof this.map === 'undefined') {\r\n      this.createMap();\r\n      this.getUserLocation();\r\n      this.loadBatiments();\r\n    }\r\n  }\r\n\r\n  createMap() {\r\n    const franceCenter = {\r\n      lat: 46.603354,\r\n      lng: 1.888334,\r\n    };\r\n\r\n    const zoomLevel = 6;\r\n\r\n    this.map = L.map('map', {\r\n      center: [franceCenter.lat, franceCenter.lng],\r\n      zoom: zoomLevel\r\n    });\r\n\r\n    const mainLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      minZoom: 2,\r\n      maxZoom: 19,\r\n    });\r\n\r\n    mainLayer.addTo(this.map);\r\n  }\r\n\r\n  getUserLocation() {\r\n    const menIcon = L.icon({\r\n      iconUrl: '../assets/men.png',\r\n      iconSize: [22, 50],\r\n      popupAnchor: [0, -30]\r\n    });\r\n\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(position => {\r\n        const userLat = position.coords.latitude;\r\n        const userLng = position.coords.longitude;\r\n\r\n        this.map!.setView([userLat, userLng], 16);\r\n\r\n        L.marker([userLat, userLng], { icon: menIcon }).addTo(this.map!).bindPopup('Your position').openPopup();\r\n\r\n      }, error => {\r\n        console.error('Geolocation error : ', error);\r\n      });\r\n\r\n    } else {\r\n      console.error('Geolocation is not supported by this browser.');\r\n    }\r\n  }\r\n\r\n  loadBatiments(): void {\r\n    this.batimentService.getBatiments().subscribe(data => {\r\n      this.batiments = data;\r\n      this.addMarkers();\r\n    });\r\n  }\r\n\r\n  addMarkers(): void {\r\n    this.batiments.forEach(batiment => {\r\n      const marker = L.marker([batiment.lat, batiment.lon]).addTo(this.map!);\r\n      \r\n      const cardContent = `\r\n        <div class=\"card\">\r\n          <img src=\"${batiment.image}\" class=\"card-img-top\" alt=\"Batiment\">\r\n          <div class=\"card-body\">\r\n            <h5 class=\"card-title\" style=\"text-align : center\">${batiment.nom}</h5>\r\n            <p class=\"card-text\">Type: ${batiment.type}</p>\r\n            <p class=\"card-text\">Statut: ${batiment.statut}</p>\r\n          </div>\r\n        </div>\r\n      `;\r\n  \r\n      marker.bindPopup(cardContent);\r\n      marker.bindTooltip(batiment.nom);\r\n      //lorsqu'on clique des details apparaissent\r\n      marker.on('click', () => {\r\n        marker.openPopup();\r\n      });\r\n      //en survole que le nom\r\n      marker.on('mouseover', () => {\r\n        marker.openTooltip();\r\n      });\r\n\r\n      marker.on('mouseout', () => {\r\n        marker.closeTooltip();\r\n      });\r\n    });\r\n  }\r\n}\r\n","<div class=\"map-wrapper\">\r\n    <div class=\"map-border\">\r\n      <div id=\"map\"></div>\r\n    </div>\r\n</div>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}